<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SB Fotocopy - Sistem POS</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="light-theme">
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-store"></i> SB Fotocopy</h2>
                <button class="theme-toggle" onclick="toggleTheme()">
                    <i class="fas fa-sun"></i>
                </button>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" onclick="showPage('dashboard')">
                    <i class="fas fa-chart-pie"></i>
                    <span>Dashboard Kasir</span>
                </a>
                <a href="#" class="nav-item" onclick="showPage('products')">
                    <i class="fas fa-boxes"></i>
                    <span>Kelola Barang</span>
                </a>
                <a href="#" class="nav-item" onclick="showPage('history')">
                    <i class="fas fa-history"></i>
                    <span>Penjualan</span>
                </a>
                <a href="#" class="nav-item" onclick="showPage('fotocopy-expenses')">
                    <i class="fas fa-calculator"></i>
                    <span>Pengeluaran</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page active">
                <div class="page-header">
                    <h1>Dashboard Kasir</h1>
                </div>

                <div class="cart-section">
                    <div class="cart atk-cart" id="atk-cart">
                        <h3><i class="fas fa-pencil-alt"></i> ATK</h3>
                        <input type="text" id="atk-search" placeholder="Cari ATK..." onkeyup="searchProducts('atk')">
                        <div class="product-list" id="atk-products"></div>
                        <div class="cart-items"></div>
                        <div class="cart-total">
                            Total: <span>Rp 0</span>
                        </div>
                    </div>

                    <div class="cart makmin-cart" id="makmin-cart">
                        <h3><i class="fas fa-coffee"></i> Makanan & Minuman</h3>
                        <input type="text" id="makmin-search" placeholder="Cari Makanan & Minuman..." onkeyup="searchProducts('makmin')">
                        <div class="product-list" id="makmin-products"></div>
                        <div class="cart-items"></div>
                        <div class="cart-total">
                            Total: <span>Rp 0</span>
                        </div>
                    </div>

                    <div class="cart fotocopy-cart" id="fotocopy-cart">
                        <h3><i class="fas fa-print"></i> Fotocopy & Print</h3>
                        <div class="fotocopy-form">
                            <div class="form-group">
                                <label>Jenis Layanan:</label>
                                <select id="fotocopy-type">
                                    <option value="">Pilih Layanan</option>
                                    <option value="fotocopy">Fotocopy</option>
                                    <option value="print-color">Print Warna</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Harga Satuan:</label>
                                <input type="number" id="fotocopy-price" min="0">
                            </div>
                            <div class="form-group">
                                <label>Jumlah:</label>
                                <input type="number" id="fotocopy-qty" min="0">
                            </div>
                            <div class="form-group">
                                <label>Catatan (opsional):</label>
                                <input type="text" id="fotocopy-note">
                            </div>
                            <button onclick="addFotocopyItem()" class="btn-primary">Tambah</button>
                        </div>
                        <div class="cart-items"></div>
                        <div class="cart-total">
                            Total: <span>Rp 0</span>
                        </div>
                    </div>
                </div>

                <div class="cart-footer">
                    <div class="grand-total">
                        Grand Total: <span id="grand-total">Rp 0</span>
                    </div>
                    <button onclick="processPayment()" class="btn-success">Proses Pembayaran</button>
                </div>
            </div>

            <!-- Products Page -->
            <div id="products-page" class="page">
                <div class="page-header">
                    <h1>Kelola Barang</h1>
                    <p>Manajemen stok dan data barang</p>
                </div>

                <div class="product-tabs">
                    <button class="tab-btn active" onclick="showProductTab('atk')">
                        <i class="fas fa-pencil-alt"></i> ATK
                    </button>
                    <button class="tab-btn" onclick="showProductTab('makmin')">
                        <i class="fas fa-coffee"></i> Makanan & Minuman
                    </button>
                </div>

                <div class="product-management">
                    <div class="management-header">
                        <div class="search-and-total">
                            <input type="text" id="product-search" placeholder="Cari barang berdasarkan kode atau nama..." onkeyup="searchProductsTable()">
                            <div id="total-products" class="total-info"></div>
                        </div>
                        <div class="filter-group">
                            <label>Urutkan berdasarkan:</label>
                            <select id="product-sort" onchange="sortProductsTable()">
                                <option value="name-asc">Alphabet (A-Z)</option>
                                <option value="name-desc">Alphabet (Z-A)</option>
                                <option value="code-asc">Kode Produk (A-Z)</option>
                                <option value="code-desc">Kode Produk (Z-A)</option>
                                <option value="stock-asc">Stok (Rendah-Tinggi)</option>
                                <option value="stock-desc">Stok (Tinggi-Rendah)</option>
                                <option value="selling_price-asc">Harga Jual (Termurah)</option>
                                <option value="selling_price-desc">Harga Jual (Termahal)</option>
                            </select>
                        </div>
                        <div class="action-buttons">
                            <button onclick="showAddProductModal()" class="btn-primary">
                                <i class="fas fa-plus"></i> Tambah Barang
                            </button>
                            <button onclick="showAddStockModal()" class="btn-primary">
                                <i class="fas fa-plus-circle"></i> Tambah Stok
                            </button>
                        </div>
                    </div>

                    <div class="product-table-container">
                        <table id="products-table" class="data-table">
                            <thead>
                                <tr>
                                    <th>No.</th>
                                    <th>Kode</th>
                                    <th>Nama Barang</th>
                                    <th>Harga Beli</th>
                                    <th>Total Modal</th>
                                    <th>Harga Jual</th>
                                    <th>Laba per Item</th>
                                    <th>Stok Saat Ini</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- History Page -->
            <div id="history-page" class="page">
                <div class="page-header">
                    <h1>Riwayat Penjualan</h1>
                    <p>Laporan dan analisis penjualan</p>
                </div>

                <div class="history-tabs">
                    <button class="tab-btn active" onclick="showHistoryTab('summary')">
                        <i class="fas fa-chart-bar"></i> Ringkasan
                    </button>
                    <button class="tab-btn" onclick="showHistoryTab('atk')">
                        <i class="fas fa-pencil-alt"></i> ATK
                    </button>
                    <button class="tab-btn" onclick="showHistoryTab('makmin')">
                        <i class="fas fa-coffee"></i> Makanan & Minuman
                    </button>
                    <button class="tab-btn" onclick="showHistoryTab('fotocopy')">
                        <i class="fas fa-print"></i> Fotocopy & Print
                    </button>
                    <button class="tab-btn" onclick="showHistoryTab('qris')">
                        <i class="fas fa-qrcode"></i> QRIS
                    </button>
                    <button class="tab-btn" onclick="showHistoryTab('cash')">
                        <i class="fas fa-money-bill-wave"></i> Cash
                    </button>
                </div>

                <div class="filter-section">
                    <div class="filter-group">
                        <label>Periode:</label>
                        <select id="period-filter" onchange="updateHistoryData()">
                            <option value="today">Hari Ini</option>
                            <option value="week">Minggu Ini</option>
                            <option value="month">Bulan Ini</option>
                            <option value="custom">Kustom</option>
                        </select>
                    </div>
                    <div class="filter-group" id="custom-date-range" style="display: none;">
                        <input type="date" id="date-from">
                        <input type="date" id="date-to">
                        <button onclick="updateHistoryData()" class="btn-secondary">Terapkan</button>
                    </div>
                    <div class="filter-group">
                        <input type="text" id="history-search" placeholder="Cari berdasarkan item, total, atau tanggal..." onkeyup="searchHistory()">
                    </div>
                </div>

                <div class="summary-cards" id="summary-cards">
                    <div class="summary-card">
                        <h4>Total Omset</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                    <div class="summary-card">
                        <h4>Total Modal</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                    <div class="summary-card">
                        <h4>Total Laba</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                    <div class="summary-card">
                        <h4>Transaksi</h4>
                        <div class="amount">0</div>
                    </div>
                    <div class="summary-card" id="fotocopy-extra" style="display: none;">
                        <h4>Total Pendapatan Fotocopy</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                    <div class="summary-card" id="print-extra" style="display: none;">
                        <h4>Total Pendapatan Print Warna</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                    <div class="summary-card" id="expenses-extra" style="display: none;">
                        <h4>Total Pengeluaran</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                </div>

                <div class="history-table-container">
                    <table id="history-table" class="data-table">
                        <thead>
                            <tr>
                                <th>Tanggal & Jam</th>
                                <th>Jenis</th>
                                <th>Nama Barang/Layanan</th>
                                <th>Metode Bayar</th>
                                <th>Harga Satuan</th>
                                <th>Qty</th>
                                <th>Total</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Pengeluaran Fotocopy Page -->
            <div id="fotocopy-expenses-page" class="page">
                <div class="page-header">
                    <h1>Pengeluaran Fotocopy</h1>
                    <p>Manajemen pengeluaran dan pendapatan fotocopy</p>
                </div>

                <div class="filter-section">
                    <div class="filter-group">
                        <label>Periode:</label>
                        <select id="expenses-period-filter" onchange="updateExpensesData()">
                            <option value="today">Hari Ini</option>
                            <option value="week">Minggu Ini</option>
                            <option value="month" selected>Bulan Ini</option>
                            <option value="custom">Kustom</option>
                        </select>
                    </div>
                    <div class="filter-group" id="expenses-custom-date-range" style="display: none;">
                        <input type="date" id="expenses-date-from">
                        <input type="date" id="expenses-date-to">
                        <button onclick="updateExpensesData()" class="btn-secondary">Terapkan</button>
                    </div>
                    <div class="filter-group">
                        <input type="text" id="expenses-search" placeholder="Cari berdasarkan deskripsi atau tanggal..." onkeyup="searchExpenses()">
                    </div>
                    <button onclick="showAddExpenseModal()" class="btn-primary">
                        <i class="fas fa-plus"></i> Tambah Pengeluaran
                    </button>
                </div>

                <div class="summary-cards" id="expenses-summary-cards">
                    <div class="summary-card">
                        <h4>Total Omset</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                    <div class="summary-card">
                        <h4>Total Pendapatan Fotocopy</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                    <div class="summary-card">
                        <h4>Total Pendapatan Print Warna</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                    <div class="summary-card">
                        <h4>Total Pengeluaran</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                    <div class="summary-card">
                        <h4>Total Laba</h4>
                        <div class="amount">Rp 0</div>
                    </div>
                </div>

                <div class="history-table-container">
                    <table id="expenses-table" class="data-table">
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Deskripsi Pengeluaran</th>
                                <th>Biaya Pengeluaran</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Payment Modal -->
    <div id="payment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Proses Pembayaran</h3>
                <span class="close" onclick="closeModal('payment-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Total Pembayaran:</label>
                    <div id="payment-total">Rp 0</div>
                </div>
                <div class="form-group">
                    <label>Metode Pembayaran:</label>
                    <select id="payment-method" onchange="toggleCashInput()">
                        <option value="cash">Cash</option>
                        <option value="qris">QRIS</option>
                    </select>
                </div>
                <div class="form-group" id="cash-input-group">
                    <label>Uang Diterima:</label>
                    <input type="number" id="payment-received" min="0" oninput="calculateChange()">
                </div>
                <div class="form-group">
                    <label>Kembalian:</label>
                    <div id="payment-change">0</div>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('payment-modal')" class="btn-secondary">Batal</button>
                <button onclick="completeSale()" class="btn-success">Selesaikan</button>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="product-modal-title">Tambah Barang</h3>
                <span class="close" onclick="closeModal('product-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="product-form">
                    <input type="hidden" id="product-id">
                    <div class="form-group">
                        <label>Jenis:</label>
                        <select id="product-type" required>
                            <option value="atk">ATK</option>
                            <option value="makmin">Makanan & Minuman</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Nama Barang:</label>
                        <input type="text" id="product-name" required>
                    </div>
                    <div class="form-group">
                        <label>Harga Beli:</label>
                        <input type="number" id="product-purchase-price" min="0" required>
                    </div>
                    <div class="form-group">
                        <label>Harga Jual:</label>
                        <input type="number" id="product-selling-price" min="0" required>
                    </div>
                    <div class="form-group">
                        <label>Stok Awal:</label>
                        <input type="number" id="product-stock" min="0" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('product-modal')" class="btn-secondary">Batal</button>
                <button onclick="saveProduct()" class="btn-success">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Add Stock Modal -->
    <div id="add-stock-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Tambah Stok</h3>
                <span class="close" onclick="closeModal('add-stock-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Cari Produk:</label>
                    <input type="text" id="stock-search" placeholder="Cari kode atau nama..." onkeyup="filterStockSelect()">
                </div>
                <div class="form-group">
                    <label>Pilih Produk:</label>
                    <select id="stock-product-select" required>
                        <option value="">-- Pilih Produk --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Jumlah Stok Ditambahkan:</label>
                    <input type="number" id="stock-add-amount" min="1" required>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('add-stock-modal')" class="btn-secondary">Batal</button>
                <button onclick="addStock()" class="btn-success">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Add Expense Modal -->
    <div id="add-expense-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Tambah Pengeluaran</h3>
                <span class="close" onclick="closeModal('add-expense-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Tanggal:</label>
                    <input type="date" id="expense-date" value="" required>
                </div>
                <div class="form-group">
                    <label>Deskripsi:</label>
                    <input type="text" id="expense-description" placeholder="Deskripsi pengeluaran..." required>
                </div>
                <div class="form-group">
                    <label>Biaya:</label>
                    <input type="number" id="expense-amount" min="0" required>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('add-expense-modal')" class="btn-secondary">Batal</button>
                <button onclick="saveExpense()" class="btn-success">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Edit Expense Modal -->
    <div id="edit-expense-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Pengeluaran</h3>
                <span class="close" onclick="closeModal('edit-expense-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <input type="hidden" id="edit-expense-id">
                <div class="form-group">
                    <label>Tanggal:</label>
                    <input type="date" id="edit-expense-date" required>
                </div>
                <div class="form-group">
                    <label>Deskripsi:</label>
                    <input type="text" id="edit-expense-description" placeholder="Deskripsi pengeluaran..." required>
                </div>
                <div class="form-group">
                    <label>Biaya:</label>
                    <input type="number" id="edit-expense-amount" min="0" required>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('edit-expense-modal')" class="btn-secondary">Batal</button>
                <button onclick="updateExpense()" class="btn-success">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Konfirmasi Hapus</h3>
                <span class="close" onclick="closeConfirmModal()">&times;</span>
            </div>
            <div class="modal-body">
                <p id="confirm-message">Yakin ingin menghapus item ini?</p>
            </div>
            <div class="modal-footer">
                <button onclick="closeConfirmModal()" class="btn-secondary">Batal</button>
                <button id="confirm-yes-btn" class="btn-danger">Hapus</button>
            </div>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>